<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to MAIHDA â€¢ MAIHDA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to MAIHDA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MAIHDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to MAIHDA</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hdbt/MAIHDA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to MAIHDA</h1>
                        <h4 data-toc-skip class="author">MAIHDA Package
Authors</h4>
            
            <h4 data-toc-skip class="date">2026-01-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hdbt/MAIHDA/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The MAIHDA package provides tools for conducting Multilevel Analysis
of Individual Heterogeneity and Discriminatory Accuracy (MAIHDA). This
approach is particularly useful for examining intersectional
inequalities in health and other outcomes by considering the joint
effects of multiple social categories.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of MAIHDA from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"hdbt/MAIHDA"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<p>The typical MAIHDA workflow consists of the following steps:</p>
<ol style="list-style-type: decimal">
<li>Create intersectional strata from multiple categorical
variables</li>
<li>Fit a multilevel model with stratum as a random effect</li>
<li>Summarize the model with variance partitioning</li>
<li>Make predictions at individual or stratum level</li>
<li>Visualize the results</li>
</ol>
</div>
<div class="section level2">
<h2 id="example-analysis">Example Analysis<a class="anchor" aria-label="anchor" href="#example-analysis"></a>
</h2>
<div class="section level3">
<h3 id="step-1-create-strata">Step 1: Create Strata<a class="anchor" aria-label="anchor" href="#step-1-create-strata"></a>
</h3>
<p>First, we create intersectional strata from multiple social
categories:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hdbt/MAIHDA" class="external-link">MAIHDA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example dataset</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  race <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"White"</span>, <span class="st">"Black"</span>, <span class="st">"Hispanic"</span><span class="op">)</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  health_outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create strata</span></span>
<span><span class="va">strata_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_strata.html">make_strata</a></span><span class="op">(</span><span class="va">data</span>, vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"race"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View stratum information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">strata_result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-fit-maihda-model">Step 2: Fit MAIHDA Model<a class="anchor" aria-label="anchor" href="#step-2-fit-maihda-model"></a>
</h3>
<p>Next, we fit a multilevel model using the created strata:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model with lme4 (default)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_maihda.html">fit_maihda</a></span><span class="op">(</span></span>
<span>  <span class="va">health_outcome</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">stratum</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">strata_result</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"lme4"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-summarize-results">Step 3: Summarize Results<a class="anchor" aria-label="anchor" href="#step-3-summarize-results"></a>
</h3>
<p>The summary provides variance partition coefficients and
stratum-specific estimates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic summary</span></span>
<span><span class="va">summary_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_maihda.html">summary_maihda</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary with bootstrap confidence intervals</span></span>
<span><span class="va">summary_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_maihda.html">summary_maihda</a></span><span class="op">(</span><span class="va">model</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span>, n_boot <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary_boot</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-make-predictions">Step 4: Make Predictions<a class="anchor" aria-label="anchor" href="#step-4-make-predictions"></a>
</h3>
<p>You can make predictions at both individual and stratum levels:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Individual-level predictions</span></span>
<span><span class="va">pred_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_maihda.html">predict_maihda</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stratum-level predictions</span></span>
<span><span class="va">pred_strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_maihda.html">predict_maihda</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"strata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred_strata</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-5-visualize-results">Step 5: Visualize Results<a class="anchor" aria-label="anchor" href="#step-5-visualize-results"></a>
</h3>
<p>The package provides several visualization options:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Caterpillar plot of stratum random effects</span></span>
<span><span class="fu"><a href="../reference/plot_maihda.html">plot_maihda</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"caterpillar"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Variance partition visualization</span></span>
<span><span class="fu"><a href="../reference/plot_maihda.html">plot_maihda</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"vpc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed vs. shrunken estimates</span></span>
<span><span class="fu"><a href="../reference/plot_maihda.html">plot_maihda</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"obs_vs_shrunken"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparing-models">Comparing Models<a class="anchor" aria-label="anchor" href="#comparing-models"></a>
</h2>
<p>You can compare multiple models with bootstrap confidence
intervals:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit multiple models</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_maihda.html">fit_maihda</a></span><span class="op">(</span><span class="va">health_outcome</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">stratum</span><span class="op">)</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">strata_result</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_maihda.html">fit_maihda</a></span><span class="op">(</span><span class="va">health_outcome</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">stratum</span><span class="op">)</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">strata_result</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare models</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_maihda.html">compare_maihda</a></span><span class="op">(</span></span>
<span>  <span class="va">model1</span>, <span class="va">model2</span>,</span>
<span>  model_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Base Model"</span>, <span class="st">"With Gender"</span><span class="op">)</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot comparison</span></span>
<span><span class="fu"><a href="../reference/plot_comparison.html">plot_comparison</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-brms-engine">Using brms Engine<a class="anchor" aria-label="anchor" href="#using-brms-engine"></a>
</h2>
<p>For Bayesian inference, you can use the brms engine (requires brms
package):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model with brms</span></span>
<span><span class="va">model_brms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_maihda.html">fit_maihda</a></span><span class="op">(</span></span>
<span>  <span class="va">health_outcome</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">stratum</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">strata_result</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"brms"</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary works the same way</span></span>
<span><span class="va">summary_brms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_maihda.html">summary_maihda</a></span><span class="op">(</span><span class="va">model_brms</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<div class="section level3">
<h3 id="variance-partition-coefficient-vpcicc">Variance Partition Coefficient (VPC/ICC)<a class="anchor" aria-label="anchor" href="#variance-partition-coefficient-vpcicc"></a>
</h3>
<p>The VPC indicates the proportion of variance in the outcome that is
attributable to differences between strata (intersectional categories).
A higher VPC suggests greater heterogeneity between strata.</p>
<ul>
<li>VPC close to 0: Most variation is within strata</li>
<li>VPC close to 1: Most variation is between strata</li>
<li>Typical values: 0.05 - 0.20 for health outcomes</li>
</ul>
</div>
<div class="section level3">
<h3 id="stratum-specific-random-effects">Stratum-Specific Random Effects<a class="anchor" aria-label="anchor" href="#stratum-specific-random-effects"></a>
</h3>
<p>The random effects represent deviations from the overall mean for
each stratum, after adjusting for fixed effects. Positive values
indicate higher outcomes in that stratum; negative values indicate lower
outcomes.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Evans, C. R., Williams, D. R., Onnela, J. P., &amp; Subramanian,
S. V. (2018). A multilevel approach to modeling health inequalities at
the intersection of multiple social identities. Social Science &amp;
Medicine, 203, 64-73.</p></li>
<li><p>Merlo, J. (2018). Multilevel analysis of individual heterogeneity
and discriminatory accuracy (MAIHDA) within an intersectional framework.
Social Science &amp; Medicine, 203, 74-80.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hamid Bulut.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
